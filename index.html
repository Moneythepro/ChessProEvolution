<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ultimate Chess</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
  <!-- ✅ Lucide Icon Library -->
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header>
      <h1><i data-lucide="chess"></i> Ultimate Chess</h1>
      <div style="display: flex; gap: 0.5rem;">
        <button id="menuBtn" title="Menu"><i data-lucide="more-horizontal"></i></button>
        <button onclick="toggleTheme()" title="Toggle Theme"><i data-lucide="moon-star"></i></button>
      </div>
    </header>

    <!-- Start Menu -->
    <div id="startMenu">
      <h2>Select Game Mode</h2>
      <label>
        Mode:
        <select id="modeSelect">
          <option value="pvp">Player vs Player</option>
          <option value="ai">Player vs AI</option>
          <option value="online" disabled>Online PvP – Coming Soon</option>
        </select>
      </label>

      <label>
        Difficulty:
        <input type="range" id="aiLevel" min="1" max="20" value="5" />
      </label>

      <label>
        Timer:
        <select id="timerSelect">
          <option value="0">No Timer</option>
          <option value="10" selected>10 Minutes</option>
          <option value="20">20 Minutes</option>
          <option value="30">30 Minutes</option>
        </select>
      </label>

      <label>
        <input type="checkbox" id="speechToggle" />
        Enable Move Speech
      </label>

      <button id="startGameBtn"><i data-lucide="play"></i> Start Game</button>
    </div>

    <!-- Main Game Section -->
    <div id="boardWrapper" style="display:none;">
      <div id="board"></div>

      <!-- Info + Timer -->
      <div id="info">
        <div id="timers">
          <div class="timer white"><i data-lucide="clock"></i> White: <span id="whiteTimer">10:00</span></div>
          <div class="timer black"><i data-lucide="clock"></i> Black: <span id="blackTimer">10:00</span></div>
        </div>
        <p>Status: <span id="status">Ready</span></p>
      </div>

      <!-- Move History -->
      <ol id="moveList"></ol>
    </div>
  </div>

  <!-- Compact 3-dot Menu Modal -->
  <div id="menuModal" style="display:none; position:fixed; top:3.5rem; right:1rem; background:var(--bg); border:1px solid var(--accent); border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.2); z-index:999;">
    <button id="exportBtn"><i data-lucide="download"></i> Export PGN</button>
    <button id="importBtn"><i data-lucide="upload"></i> Import PGN</button>
    <button id="toggleHistoryBtn"><i data-lucide="scroll"></i> Toggle History</button>
    <label style="padding: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
      <input type="checkbox" id="speechToggleMenu" onchange="speechToggle.checked = this.checked;" />
      <i data-lucide="mic"></i> Move Speech
    </label>
  </div>

  <!-- Winner Modal -->
  <div id="winnerModal" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%);
    background:var(--bg); color:var(--text); padding:2rem; border-radius:12px; border:2px solid var(--accent);
    box-shadow:0 4px 20px rgba(0,0,0,0.3); text-align:center; z-index:999;">
    <h2 id="winnerText">Checkmate!</h2>
    <button onclick="newGame()" style="margin-top:1rem; padding:0.6rem 1.2rem; font-size:1rem;
      background:var(--accent); color:white; border:none; border-radius:8px;">
      <i data-lucide="rotate-ccw"></i> Play Again
    </button>
  </div>

  <!-- ✅ Chess.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>

  <!-- ✅ Stockfish as Web Worker -->
  <script>
    window.stockfish = new Worker("stockfish.js");
  </script>

  <!-- ✅ Main Logic -->
  <script src="app.js"></script>

  <!-- ✅ Activate Lucide icons -->
  <script>
    lucide.createIcons();
  </script>
</body>
</html>
